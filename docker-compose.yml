services:
      web:
        image: nginx:latest
        ports:
          - "8085:80"
        volumes:
          - ./html:/usr/share/nginx/html
          - ./nginx.conf:/etc/nginx/conf.d/default.conf
          - ./wait-for-it.sh:/wait-for-it.sh
        command: ["/wait-for-it.sh", "app:5000", "--", "nginx", "-g", "daemon off;"]
        depends_on:
          - app
        networks:
          - todo-network
      db:
        image: postgres:latest
        env_file:
          - .env
        healthcheck:
          test: ["CMD-SHELL", "pg_isready -U igor"]
          interval: 5s
          timeout: 5s
          retries: 5
        networks:
          - todo-network
      app:
        build:
          context: .
          dockerfile: Dockerfile
        ports:
          - "5000:5000"
        volumes:
          - ./app:/app
        env_file:
          - .env
        depends_on:
          - db
        networks:
          - todo-network
networks:
      todo-network:
        driver: bridge
